title: Check for Accounts with RDP privileges
category: 
  - AD:
    - Privileged Groups
tactic: Lateral Movement
tags: []
description: Check if user accounts have RDP privileges on any hosts
references:
steps:
  
  - description: Check using bloodhound
    options:
      - tool: bloodhound
        usage: check the GUI and embedded bloodhound requests
        comments:
  
  - description: Additionally check for RDP access using patator
    options:
      - tool: patator
        usage: patator rdp_login host=FILE0 user=<domain/smpwduser> password='<P@ssw0rd>' 0=ad_hosts.txt -x ignore:mesg=ERRCONNECT_CONNECT_TRANSPORT_FAILED
        comments:
          - ERRCONNECT_CONNECT_CANCELLED error code means that the password is ok and the user has RDP privileges, 
            but there is a messag prompt that the current user will be disconnected

comments: 
  Both options should be checked

  