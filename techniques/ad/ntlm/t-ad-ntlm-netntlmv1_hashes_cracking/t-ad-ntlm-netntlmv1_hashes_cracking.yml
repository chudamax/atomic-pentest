title: Crack NetNTLMv1 hashes locally
category: 
  - AD:
    - NTLM
    
tactic: Credential Access
tags: []
description: |
  NetNTLMv1 uses the Data Encryption Standard (DES) algorithm as part of its hash computation process.
  The hash NT (16bytes) is divided in 3 parts of 7bytes each.

  Modern hardware, especially GPUs, can compute DES hashes very quickly, which makes brute force attacks 
  even more effective. Moreover, there are many readily available software tools that are designed 
  to crack NetNTLMv1 hashes.

references:
  - https://github.com/evilmog/ntlmv1-multi

steps:

  - description: Use NTLMv1 Multitool to convert the NetNTLMv1 response to a proper hash
    options: 
      - tool: ntlmv1-multi
        usage: python3 ntlmv1.py --ntlmv1 hashcat::HOSTNAME:<PART1>:<PART2>:<CHALLANGE>
        comments: <CHALLANGE> is usually 1122334455667788
        
  - description: Calculate final 4 characters (CT3)
    options: 
      - tool: ntlmv1-multi
        usage: ./ct3_to_ntlm.bin <CT3> <CHALLANGE>
        comments: 
  
  - description: Crack 2 parts with hashcat
    options: 
      - tool: hashcat
        usage: |
          To crack with hashcat create a file with the following contents:
          <CT1>:1122334455667788
          <CT2>:1122334455667788

          ./hashcat -m 14000 -a 3 -1 charsets/DES_full.charset --hex-charset hashes.txt ?1?1?1?1?1?1?1?1
        comments: 
        
comments: 
  - For NTLMv1 with ESS/SSP the process is a bit different, check the references
  - If it was not possible to crack the hash, NTLM relay technique can be used