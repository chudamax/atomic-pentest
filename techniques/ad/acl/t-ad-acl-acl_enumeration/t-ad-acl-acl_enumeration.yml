title: ACL Enumeration
category: 
  - AD:
    - ACL
tactic: Discovery
tags: []
description: 
  - title:
    content: ACL Enumeration
    references:
      - type: link
        value: https://habr.com/ru/companies/solarsecurity/articles/681108/
      - type: link
        value: https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse
      - type: link
        value: https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces
steps:
  - description: ACL Enumeration
    options: 
      - tool: bloodhound
        usage: |
          MATCH p=(u:User)-[r1]->(n) WHERE r1.isacl=true RETURN p
          MATCH p=(u:Computer)-[r1]->(n) WHERE r1.isacl=true RETURN p
        comments:
      
      - tool: powerview
        usage: |
          Find-InterestingDomainAcl -ResolveGUIDs | Export-CSV -NoTypeInformation acls.csv
          Find-InterestingDomainAcl -ResolveGUIDs | select IdentityReferenceName, ObjectDN, ActiveDirectoryRights | fl
          
          #Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceClass -match "user"}
          #Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceClass -match "computer"}
        comments: The generated file can be quite big

comments: