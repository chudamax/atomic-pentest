title: Accounts That Have Never Logged In
category: 
  - AD:
    - Account Review
tactic: Discovery
tags: []
description: 
  - title:
    content: Check if there are any Windows user accounts that have never logged in.

steps:
  - description: Enumerate user accounts that have never logged in.
    options:
      - tool: Powershell AD Module
        usage: >
          Get-ADUser -Filter * -Properties Name, sAMAccountName, LastLogonDate, whencreated 
          | Where { $_.LastLogonDate -eq $null -and $_.Enabled -eq $True -and $_.DistinguishedName 
          -notlike "*HealthMailbox*"} | Format-Table -AutoSize -Property sAMAccountName, LastLogonDate, whencreated
        comments:
          - You can add "| Measure-Object" to the powershell command to get a total number of the accounts

      - tool: ldapsearch
        usage: >
          ldapsearch -x -H ldap://<dc_ip> -D "<user@domain.com>" -w '<password>' -b "DC=<domain,DC=com>" 
          "(&(objectCategory=person)(objectClass=user)(lastLogon=0))" sAMAccountName 
          | grep dn |grep -v HealthMailbox  | wc
        comments:

      - tool: bloodhound
        usage: >
          MATCH (u:User) WHERE u.lastlogon IN [-1.0, 0.0] AND NOT u.name starts with 'HEALTHMAILBOX' 
          RETURN u.name, datetime({epochSeconds:toInteger(u.whencreated)})
        comments: 

comments:
  