title: MSRPC Enumeration
category: 
  - AD:
    - RPC
tactic: Enumeration
tags: []
description: MSRPC, or Microsoft Remote Procedure Call, is a modified version of the standard 
  DCE-RPC (Distributed Computing Environment/Remote Procedure Calls) protocol. DCE-RPC is a protocol that allows 
  for remote execution of procedures or methods across a network, essentially letting different software components 
  communicate in a distributed computing environment.

  MSRPC can use multiple transport protocols including TCP/IP, SMB to establish 
  communications between the client and the server. Along with IPC$ transport, TCP, UDP, and HTTP are used to 
  provide access to services.

  In MSRPC, the specific services available for remote procedure calls are referred to as "endpoints." 
  These can be dynamically or statically allocated.

references:
  - https://www.schauer.fr/wp-content/uploads/2018/02/msrpc_null_sessions.pdf
  - https://0xffsec.com/handbook/services/msrpc/
  - https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb/rpcclient-enumeration
  - https://wiki.porchetta.industries/smb-protocol/enumeration/enumerate-null-sessions
  - https://sensepost.com/blog/2018/a-new-look-at-null-sessions-and-user-enumeration/

steps:
  - description: Get the list of RPC endpoints
    options: 
      - tool: impacket-rpcdump
        usage: impacket-rpcdump
  
  - description: Dump data
    options: 
      - tool: impacket-samrdump
        usage: impacket-samrdump
      
      - tool: rpcclient
        usage: |
          #Use rpcclient help to see options to request more data
          rpcclient -c querydispinfo -U''%'' dc.domain.local